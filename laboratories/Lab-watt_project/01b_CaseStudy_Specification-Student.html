
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>8.3. TP1 - Case study specification [Student Version] &#8212; Sizing and optimization of mechatronic systems</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'laboratories/Lab-watt_project/01b_CaseStudy_Specification-Student';</script>
    <link rel="icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.5. TD1/2 - Hydrid storage architecture &amp; specification [Student version]" href="02b_Architecture_Hybrid-Student.html" />
    <link rel="prev" title="8.2. Case study presentation" href="01a_CaseStudy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../about/homepage.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Sizing and optimization of mechatronic systems - Home"/>
    <img src="../../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Sizing and optimization of mechatronic systems - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../about/context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/installation.html">Installation guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Classes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../classes/Lecture0/summary.html">1. Concept of Operations and architectures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture0/1-concept_of_operations.html">1.1. Concept of Operations</a></li>



<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture0/2-system_architectures.html">1.5. System architectures</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture0/3-architectures_sizing.html">1.8. Preliminary design of mechatronic system</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../classes/Lecture1_new/summary.html">2. Components, technologies, design drivers and sizing scenarios</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture1_new/1-scenarios_and_design_drivers.html">2.1. Scenarios and Design Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture1_new/2-quiz_DesignDrivers.html">2.2. Quiz - Design drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture1_new/3-quiz_SizingScenarios.html">2.3. Quiz - Sizing scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture1_new/4-technologies.html">2.4. Components and Technologies for Mechatronic Systems</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../classes/Lecture2_new/summary.html">3. Estimation models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture2_new/1-linear_regressions.html">3.1. Linear regressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture2_new/2-quiz_regressions.html">3.2. Quiz - Linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture2_new/3-scaling_laws.html">3.3. Scaling laws</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture2_new/4-quiz_scaling_laws.html">3.4. Quiz - Scaling Laws</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../classes/Lecture3_new/summary.html">4. Simulation and evaluation models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture3_new/1-simulation_models.html">4.1. Simulation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture3_new/2-quiz_simulation_models.html">4.2. Quiz - Simulation models</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture3_new/3-evaluation_models.html">4.5. Evaluation models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture3_new/4-quiz_evaluation_models.html">4.6. Quiz - Evaluation models</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../classes/Lecture4_new/summary.html">5. Optimal sizing procedures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture4_new/1-design_and_optimization_problems.html">5.1. Representation of a Design Problem and Fundamentals of Optimal Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture4_new/2-optimization_examples.html">5.2. Optimization with python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture4_new/3-sizing_procedures.html">5.3. Development of a sizing procedure using design graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../classes/Lecture4_new/4-sizing_procedure_examples.html">5.4. Design graph and optimization with python</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratories</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Lab-package_delivery_UAV/summary.html">6. Package delivery UAV</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/1-conops.html">6.1. Package Delivery UAV Concept of Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/1-conops-student.html">6.2. Package Delivery UAV Concept of Operations (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/2-system_architectures-student.html">6.3. System architectures of the Package Delivery UAV (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/2-system_architectures.html">6.4. System Architecture Selection for a Package Delivery UAV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/3-sizing_scenarios.html">6.5. Sizing scenarios and design drivers</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/3-sizing_scenarios-student.html">6.7. Sizing scenarios and design drivers (student version)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/4-estimation_models-linear_regression.html">6.9. Estimation models with dimensional analysis and linear regressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/4-estimation_models-linear_regression-student.html">6.10. Estimation models with dimensional analysis and linear regressions  (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/4-estimation_models-scaling_laws.html">6.11. Estimation models with scaling laws</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/4-estimation_models-scaling_laws-student.html">6.12. Scaling laws of electrical components (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/5-simulation_models-student.html">6.13. Simulation models (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6-sizing_models_introduction.html">6.14. Sizing models for multi-rotor definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6a-propeller_selection.html">6.15. Propeller selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6a-propeller_selection-student.html">6.16. Propeller selection (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6b-motor_selection.html">6.17. Motor selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6b-motor_selection-student.html">6.18. Motor selection  (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6c-battery_esc_selection.html">6.19. Battery and ESC selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6c-battery_esc_selection-student.html">6.20. Battery and ESC selection (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6d-frame_selection.html">6.21. Frame selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/6d-frame_selection-student.html">6.22. Frame selection (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/7-system_sizing_code_optimization.html">6.23. Sizing of a multirotor drone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/7-system_sizing_code_optimization-student.html">6.24. Sizing of a multirotor drone (ISAE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/8-design_exploration-student.html">6.25. Design optimization and exploration of a multirotor drone (ISAE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-package_delivery_UAV/A1-sizing_equations.html">6.26. Appendix 1: Sizing equations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Lab-vega/summary.html">7. VEGA Launcher TVC EMA</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/1-sizing_scenarios-student.html">7.1. Modeling of the mechanical load (student version)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/1-sizing_scenarios.html">7.3. Modeling of the mechanical load</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/2-estimation_models-student.html">7.5. Estimation models with scaling laws and linear regression (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/2-estimation_models.html">7.6. Estimation models with scaling laws and linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/3-simulation_models-student.html">7.7. Simulation models with Python (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/3-simulation_models.html">7.8. Simulation models with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/4-evaluation_models-student.html">7.9. Evaluation models: endurance of the actuator (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/4-evaluation_models.html">7.10. Evaluation models: endurance of the actuator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/5-sizing_and_optimization-student.html">7.11. Sizing procedure and optimization (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/5-sizing_and_optimization.html">7.12. Sizing procedure and optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/6-sizing_and_optimization_with_mdao_using_om-student.html">7.13. Sizing procedure and optimization with OpenMDAO (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lab-vega/6-sizing_and_optimization_with_mdao_using_om.html">7.14. Sizing procedure and optimization with OpenMDAO</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="summary-short.html">8. Lab - Sustainable mobility - Mission profile &amp; Specification</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_SustainableMobility.html">8.1. Sustainable mobilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="01a_CaseStudy.html">8.2. Case study presentation</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8.3. TP1 - Case study specification [Student Version]</a></li>

<li class="toctree-l2"><a class="reference internal" href="02b_Architecture_Hybrid-Student.html">8.5. TD1/2 - Hydrid storage architecture &amp; specification [Student version]</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="summary.html">9. Lab - Sustainable mobility - DC/DC converter sizing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="03_SizingScenarios.html">9.1. Equations of sizing scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_ScalingLaws-Student.html">9.2. Estimation models with scaling laws and linear regression (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_ScalingLaws.html">9.3. Estimation models with scaling laws and linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_HeatsinkLinearRegression-Student.html">9.4. Heatsink  estimation models with simple and multiple linear regressions (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_HeatsinkLinearRegression.html">9.5. Heatsink  estimation models with simple and multiple linear regressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_SizingCodeInductor.html">9.6. Sizing code of an inductor</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_SizingCodeInductor-Surrogate-Student.html">9.7. Sizing code of an inductor with surrogate models (Student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_SizingCodeInductor-Surrogate.html">9.8. Sizing code of an inductor with surrogate models</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_DCDC_converter_sizing_introduction.html">9.9. Design graphs for the sizing a DC/DC converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_SizingCodeDCDCconverter.html">9.10. Sizing code of a DC/DC converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_LCA_Inductor-Student.html">9.11. Life Cycle Assessment of an inductor (student version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_LCA_Inductor.html">9.12. Life Cycle Assessment of an inductor</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/SizingLab/sizing_course/main?urlpath=lab/tree/laboratories/Lab-watt_project/01b_CaseStudy_Specification-Student.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/SizingLab/sizing_course/blob/main/laboratories/Lab-watt_project/01b_CaseStudy_Specification-Student.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SizingLab/sizing_course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SizingLab/sizing_course/edit/main/laboratories/Lab-watt_project/01b_CaseStudy_Specification-Student.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SizingLab/sizing_course/issues/new?title=Issue%20on%20page%20%2Flaboratories/Lab-watt_project/01b_CaseStudy_Specification-Student.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/laboratories/Lab-watt_project/01b_CaseStudy_Specification-Student.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>TP1 - Case study specification [Student Version]</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">8.3. TP1 - Case study specification [Student Version]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">8.4. Table of Contents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vehicles-definition">8.4.1. Vehicles definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mission-profile-definition-and-consumption-simulation">8.4.2. Mission profile definition and consumption simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatically-find-speed-profile-decomposition-k1-k2-k3-with-an-optimization-process">8.4.3. Automatically find speed profile decomposition (k1, k2, k3) with an optimization process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#different-vehicules-energetic-comparison">8.4.4. Different vehicules energetic comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework">8.4.5. Homework</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="Sizing Lab" src="https://raw.githubusercontent.com/SizingLab/sizing_course/main/laboratories/Lab-watt_project/assets/images/Baniere.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="tp1-case-study-specification-student-version">
<h1><span class="section-number">8.3. </span>TP1 - Case study specification [Student Version]<a class="headerlink" href="#tp1-case-study-specification-student-version" title="Link to this heading">#</a></h1>
<p><em>Written by Marc Budinger, INSA Toulouse, France</em></p>
<p>The objective of this notebook is to develop tools to:</p>
<ul class="simple">
<li><p>generate typical point-ot-point mission profiles to analyse the energetic performance of different mobility;</p></li>
<li><p>optimize thoose given profiles shapes/strategy to minimize consumption;</p></li>
</ul>
<p>In order to have flexibility in the definition of the case studies, an object-oriented programming approach will be used and links will be given to understand the formalism.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1><span class="section-number">8.4. </span>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Vehicles-definition"><span class="xref myst">Vehicles definition</span></a></p></li>
<li><p><a class="reference internal" href="#Mission-profile-definition-and-consumption-simulation"><span class="xref myst">Mission profile definition and consumption simulation</span></a></p></li>
<li><p><a class="reference internal" href="#Automatically-find-speed-profile-decomposition-(k1,-k2,-k3)-with-an-optimization-process"><span class="xref myst">Automatically find speed profile decomposition (k1, k2, k3) with an optimization process</span></a></p></li>
<li><p><a class="reference internal" href="#Different-vehicules-energetic-comparison"><span class="xref myst">Different vehicules energetic comparison</span></a></p></li>
<li><p><a class="reference internal" href="#Homework"><span class="xref myst">Homework</span></a></p></li>
</ol>
<section id="vehicles-definition">
<h2><span class="section-number">8.4.1. </span>Vehicles definition<a class="headerlink" href="#vehicles-definition" title="Link to this heading">#</a></h2>
<p>Different types of urban electric vehicles exist (tram, trolley bus, <a class="reference external" href="https://blog.hcigroupe.com/de-6-%C3%A0-24-m%C3%A8tres-tour-dhorizon-des-diff%C3%A9rentes-longueurs-de-bus">electric bus</a>), we can define a general vehicle <a class="reference external" href="https://www.w3schools.com/python/python_classes.asp">class</a> which can represent the multiple possible supports.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">vehicle</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MaxSpeed</span><span class="p">,</span> <span class="n">MaxAcc</span><span class="p">,</span> <span class="n">NumberPass</span><span class="p">,</span> <span class="n">Weight</span><span class="p">,</span> <span class="n">Crr</span><span class="p">,</span> <span class="n">Cd</span><span class="p">,</span> <span class="n">FrontArea</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaxSpeed</span> <span class="o">=</span> <span class="n">MaxSpeed</span> <span class="c1"># [m/s] maximal speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NumberPass</span> <span class="o">=</span> <span class="n">NumberPass</span> <span class="c1"># [-] passenger capacity (pass/veh)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Weight</span> <span class="o">=</span> <span class="n">Weight</span> <span class="c1"># [kg] effective weight (with passenger: add 62kg/pass)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Crr</span> <span class="o">=</span> <span class="n">Crr</span> <span class="c1"># [-] rolling resistance coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cd</span> <span class="o">=</span> <span class="n">Cd</span> <span class="c1"># [-] drag coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FrontArea</span> <span class="o">=</span> <span class="n">FrontArea</span> <span class="c1"># [m²] frontal area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="n">MaxAcc</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">update_acc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MaxAcc</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaxAcc</span> <span class="o">=</span> <span class="n">MaxAcc</span> <span class="c1"># [m/s²] maximal acceleration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Weight</span><span class="o">*</span><span class="n">MaxAcc</span> <span class="c1"># [N] max traction force</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fmax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">MaxSpeed</span> <span class="c1"># [W] max corner power</span>
</pre></div>
</div>
</div>
</div>
<p>Here you will find some useful vehicle characteristics for the rest of the study.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head text-center"><p>Tram</p></th>
<th class="head text-center"><p>Trolleybus</p></th>
<th class="head text-center"><p>Bus</p></th>
<th class="head text-center"><p>Car (Tesla 3)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Maximum operational speed</p></td>
<td class="text-center"><p>60 km/h</p></td>
<td class="text-center"><p>60 km/h</p></td>
<td class="text-center"><p>50 km/h</p></td>
<td class="text-center"><p>100 km/h (1st gear)</p></td>
</tr>
<tr class="row-odd"><td><p>Acceleration and braking</p></td>
<td class="text-center"><p>1.2 m/s²</p></td>
<td class="text-center"><p>1.2 m/s²</p></td>
<td class="text-center"><p>1.2 m/s²</p></td>
<td class="text-center"><p>4.6 m/s²</p></td>
</tr>
<tr class="row-even"><td><p>Passenger capacity</p></td>
<td class="text-center"><p>220</p></td>
<td class="text-center"><p>138</p></td>
<td class="text-center"><p>95</p></td>
<td class="text-center"><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>Vehicle effective weight &#64; 62 kg/p</p></td>
<td class="text-center"><p>57049 kg</p></td>
<td class="text-center"><p>27656 kg</p></td>
<td class="text-center"><p>19500 kg</p></td>
<td class="text-center"><p>1800 kg</p></td>
</tr>
<tr class="row-even"><td><p>Rolling resistance coefficient</p></td>
<td class="text-center"><p>0.006</p></td>
<td class="text-center"><p>0.015</p></td>
<td class="text-center"><p>0.015</p></td>
<td class="text-center"><p>0.015</p></td>
</tr>
<tr class="row-odd"><td><p>Aerodynamic drag coefficient</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>0.6</p></td>
<td class="text-center"><p>0.23</p></td>
</tr>
<tr class="row-even"><td><p>Frontal area</p></td>
<td class="text-center"><p>8.5 m²</p></td>
<td class="text-center"><p>8.5 m²</p></td>
<td class="text-center"><p>8.5 m²</p></td>
<td class="text-center"><p>2.22 m²</p></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<div><p><strong>Exercise 1:</strong> Define the 4 instances corresponding to the vehicles described in the above table.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tram</span> <span class="o">=</span> <span class="n">vehicle</span><span class="p">(</span><span class="n">MaxSpeed</span><span class="o">=</span><span class="mi">60</span><span class="o">*</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">MaxAcc</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">NumberPass</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span> <span class="n">Weight</span><span class="o">=</span><span class="mi">57049</span><span class="p">,</span> <span class="n">Crr</span><span class="o">=</span><span class="mf">0.006</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">FrontArea</span><span class="o">=</span><span class="mf">8.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mission-profile-definition-and-consumption-simulation">
<h2><span class="section-number">8.4.2. </span>Mission profile definition and consumption simulation<a class="headerlink" href="#mission-profile-definition-and-consumption-simulation" title="Link to this heading">#</a></h2>
<p>The objective now is to simulate the dynamic evolution of the main mechanical quantities (position, speed, acceleration, traction/braking force, traction/braking power and cumulated energy) on typical sections of urban routes (a point-to-point scenario).</p>
<p>When a vehicle travels from point A (Starting point - v=0km/h) to point B (Stopping point - v=0km/h) it generally passes through four stages namely:</p>
<ul class="simple">
<li><p>Acceleration portion (traction force is considered constant);</p></li>
<li><p>Maintained speed portion (or null acceleration);</p></li>
<li><p>Coasting/freewheel portion: traction/braking force is null;</p></li>
<li><p>Braking portion (braking force is considered constant).</p></li>
</ul>
<p>The control points for switching from one portion to the other one are defined in the following code by using 3 ratio parameters <span class="math notranslate nohighlight">\(k_1, k_2, k_3\)</span> as shown in the figure below:</p>
<center><img src="https://raw.githubusercontent.com/SizingLab/sizing_course/main/laboratories/Lab-watt_project/assets/images/GeneralspeedProfile.PNG" alt="General Speed Profile" /></center>
<blockquote>
<div><p><strong>Exercise 2:</strong> Try to find the shape of the acceleration=f(distance) and propulsive\braking-force=f(distance) curves.</p>
</div></blockquote>
<p>A code skeleton initial implementation is given to define a point-to-point dynamic simulation.
The idea is to propose a simple <a class="reference external" href="https://fr.wikipedia.org/wiki/R%C3%A9solution_num%C3%A9rique_des_%C3%A9quations_diff%C3%A9rentielles">Euler inegration</a> of vehicle longitudinal dynamics and calculate associated data (power, energy) across the entire profile.</p>
<blockquote>
<div><p><strong>Exercise 3:</strong> Based on available data, implement longitudinal dynamic differential equation (PFD) in CODE 2 section. What force/parameter evolution could be added to take into account variations in altitude?</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">class</span> <span class="nc">SimulSection</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">Distance</span><span class="p">,</span> <span class="n">MeanSpeed</span><span class="p">,</span> <span class="n">BrakeRatioMax</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        
        <span class="c1"># Parameters definition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span> <span class="o">=</span> <span class="n">Vehicle</span> <span class="c1"># store vehicle class instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="n">Distance</span> <span class="c1"># [m] A-B distance to travel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MeanSpeed</span> <span class="o">=</span> <span class="n">MeanSpeed</span> <span class="c1"># [m/s] Mean Speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TravelTime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">MeanSpeed</span>  <span class="c1"># [s] Travel time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BrakeRatioMax</span> <span class="o">=</span> <span class="n">BrakeRatioMax</span> <span class="c1"># [-], &lt;1 =F_braking/f_propulsion (to reproduce driver behavior)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span> <span class="c1"># Time step for numerical solver</span>

        <span class="c1"># Constants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="mf">1.25</span> <span class="c1"># [kg/m3] air density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="c1"># [m/s²] gravity</span>
        
        <span class="c1"># Validate vehicle limits match specifications (print warning):</span>
        <span class="c1">#    - max acceleration/braking vs. Vmean and distance (triangular acceleration profile)</span>
        <span class="c1">#    - Vmean vs. max speed on trapezoidal profile</span>
        <span class="c1">###############################################</span>
        <span class="c1"># CODE 1</span>
        <span class="c1">###############################################</span>

    <span class="k">def</span> <span class="nf">update_acc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MaxAcc</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="n">MaxAcc</span><span class="p">)</span>
        <span class="c1"># Validate vehicle limits match specifications (print warning):</span>
        <span class="c1">#    - max acceleration/braking vs. Vmean and distance (triangular acceleration profile)</span>
        <span class="c1">#    - Vmean vs. max speed on trapezoidal profile</span>
        <span class="c1">###############################################</span>
        <span class="c1"># CODE 1</span>
        <span class="c1">###############################################</span>
            
    <span class="c1"># local derivative of the vehicle state vector y (y=[x, dx/dt], x being the longitudinal position)</span>
    <span class="k">def</span> <span class="nf">derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">F</span><span class="p">):</span>
        
        <span class="c1"># state</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">dxdt</span> <span class="o">=</span> <span class="n">y</span>
        
        <span class="c1"># Define derivative d²xdt²</span>
        <span class="c1">###############################################</span>
        <span class="c1"># CODE 2</span>
        <span class="c1">###############################################</span>
        
        <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dxdt2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dydt</span> 

  
    <span class="c1"># https://perso.crans.org/besson/publis/notebooks/Runge-Kutta_methods_for_ODE_integration_in_Python.html</span>
    <span class="c1"># solver numerique</span>
        
    <span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">profile_ratios</span><span class="p">):</span>
        
        <span class="c1"># save profile ratios</span>
        <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span> <span class="o">=</span> <span class="n">profile_ratios</span>
        <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="c1"># [s] integration time step</span>

        <span class="c1"># initialise vectors (time, position, speed, acceleration, power @ wheel, force @ wheel, energy @ wheel)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">asection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">psection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># while vehicle speed remains positive point B is not reached</span>
        <span class="n">y</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">):</span>
            
            <span class="c1"># Depending on profile section/portion, define wheel force</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">k1</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">k3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">):</span>
                <span class="n">F</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Fmax</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">k3</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">):</span>
                <span class="n">F</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Crr</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Weight</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">FrontArea</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Cd</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">k3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">):</span>
                <span class="n">F</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">F</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">BrakeRatioMax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Fmax</span>

            <span class="c1"># Perform a simple Euler integration from t to t+dt</span>
            <span class="n">dydt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
                
            <span class="c1"># Save vectors</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tsection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsection</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dt</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xsection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsection</span> <span class="o">+</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsection</span> <span class="o">+</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">psection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">psection</span> <span class="o">+</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">asection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asection</span> <span class="o">+</span> <span class="p">[</span><span class="n">dydt</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">Fsection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fsection</span> <span class="o">+</span> <span class="p">[</span><span class="n">F</span><span class="p">]</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">dt</span><span class="p">]</span>
            
    <span class="c1"># Plot all the results vs. specification in graphs</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xsection</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">)),</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Specified distance&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsection</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MeanSpeed</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">)),</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Specified mean speed&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vsection</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">)),</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Profile mean speed&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Speed (m/s)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>    
        
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fsection</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Force (N)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">asection</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Acceleration (m/s²)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Power (kW)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (kJ)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span> 
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">ConsumptionPerPax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Consumption per passenger: </span><span class="si">%.2f</span><span class="s2"> kJ/(Pax.km)&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">NumberPass</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">NumberPass</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">MaxEnergyPoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max energy discharge: </span><span class="si">%.0f</span><span class="s2"> kJ&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span>

    <span class="k">def</span> <span class="nf">MaxPowerPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max power discharge: </span><span class="si">%.0f</span><span class="s2"> kW&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max power recharge: </span><span class="si">%.0f</span><span class="s2"> kW&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">psection</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-3</span>
    
</pre></div>
</div>
</div>
</div>
<p>To check that the developed code does not containt errors, let us apply following Tram example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definition of the section under study</span>
<span class="n">Travel_Tram</span> <span class="o">=</span> <span class="n">SimulSection</span><span class="p">(</span><span class="n">Vehicle</span><span class="o">=</span><span class="n">Tram</span><span class="p">,</span> <span class="n">Distance</span><span class="o">=</span><span class="mi">670</span><span class="p">,</span> <span class="n">MeanSpeed</span><span class="o">=</span><span class="mi">26</span><span class="o">*</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">BrakeRatioMax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Duration of traject for given mean speed: </span><span class="si">{:.2f}</span><span class="s1">s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">670</span><span class="o">/</span><span class="p">(</span><span class="mi">26</span><span class="o">*</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">3600</span><span class="p">)))</span>

<span class="c1"># Profile integration, plotting and consummption per passenger evaluation</span>
<span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mf">0.036125972011676784</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.9638740279883232</span><span class="p">]</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">ConsumptionPerPax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MaxPowerPoints</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of traject for given mean speed: 92.77s
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># Profile integration, plotting and consummption per passenger evaluation</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="mf">0.036125972011676784</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.9638740279883232</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">ConsumptionPerPax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nn">Cell In[3], line 84,</span> in <span class="ni">SimulSection.solver</span><span class="nt">(self, profile_ratios)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>     <span class="n">F</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">BrakeRatioMax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Fmax</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> <span class="c1"># Perform a simple Euler integration from t to t+dt</span>
<span class="ne">---&gt; </span><span class="mi">84</span> <span class="n">dydt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="c1"># Save vectors</span>

<span class="nn">Cell In[3], line 47,</span> in <span class="ni">SimulSection.derivative</span><span class="nt">(self, y, F)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">x</span><span class="p">,</span> <span class="n">dxdt</span> <span class="o">=</span> <span class="n">y</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1"># Define derivative d²xdt²</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="c1">###############################################</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="c1"># CODE 2</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="c1">###############################################</span>
<span class="ne">---&gt; </span><span class="mi">47</span> <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dxdt2</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="k">return</span> <span class="n">dydt</span>

<span class="ne">NameError</span>: name &#39;dxdt2&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>When we look at the speed profile we can easily imagine two extrema cases :</p>
<ul class="simple">
<li><p>a <a class="reference external" href="https://fr.wikipedia.org/wiki/Loi_de_mouvement">triangular speed profile</a> (acceleration/deceleration, without constant speed &amp; freewheel portion)</p></li>
<li><p>a <a class="reference external" href="https://fr.wikipedia.org/wiki/Loi_de_mouvement">trapezoidal speed profile</a> (without freewheel portion)
They kind of relate to maximum performances achievable given the vehicle parameters.
The idea here is to compare the profile defined by user (average speed/distance, maximum brake decceleration) to extreme vehicle performances to see if it is feasible (i.e. a [k1, k2, k3] can be found).</p></li>
</ul>
<blockquote>
<div><p><strong>Exercise 4:</strong> Give the relationship between acceleration, braking ratio, average speed and distance traveled for triangular speed profile (k1=k2=1) if we assume the acceleration and braking phases are perfectly linear (i.e. resistive force negligible)! Start first to link k3 to braking ratio</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise 5:</strong> Give the relationship between k1 and k3 (k2=1) if we assume the acceleration and braking phases are perfectly linear (the resistive force is neglected) and equal (braking ratio =1 to simplify). Find then the relationship between max speed, average speed, ditance and acceleration. Then highligh the link between k3, max speed, acceleration and distance.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise 6:</strong> Complete CODE 1 section with checks and warnings based on exercice 4 calculations (compare also max speed to vehicle max speed). Check warning using following low acceleration tram instance.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>

<span class="c1"># Test of lower acceleration</span>
<span class="n">Travel_Tram_low_acc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">Travel_Tram</span><span class="p">)</span>
<span class="n">Travel_Tram_low_acc</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Test of lower max speed</span>
<span class="n">Travel_Tram_low_acc</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">MaxSpeed</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">3600</span>
<span class="n">Travel_Tram_low_acc</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>We whant to plot the curve linking the reached maximum speed and the maximum acceleration for a trapezoidal profile. Check that following formulation match your previous equation solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evalutation of maximum speed and k1/k3 coefficients</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>

<span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MeanSpeed</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span> <span class="n">Tram</span><span class="o">.</span><span class="n">MaxAcc</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">vmax</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">Distance</span><span class="o">/</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MeanSpeed</span><span class="o">-</span><span class="p">((</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">Distance</span><span class="o">/</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MeanSpeed</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">Distance</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Acceleration (m/s²)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Max speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">k3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">vmax</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">Travel_Tram</span><span class="o">.</span><span class="n">Distance</span><span class="p">)</span>
<span class="n">k1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">k3</span><span class="p">)</span><span class="o">/</span><span class="n">k3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">k1</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;k1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">k3</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;k3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Acceleration (m/s²)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Max speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/61e9b18530ea7078ea1b43870de4ccfacd1c30d479e9c18e47c824ff95a0edcf.png" src="../../_images/61e9b18530ea7078ea1b43870de4ccfacd1c30d479e9c18e47c824ff95a0edcf.png" />
<img alt="../../_images/02c11a61524897f6c68ce317066573aab12bbc6ff412de65fc216f326448c52a.png" src="../../_images/02c11a61524897f6c68ce317066573aab12bbc6ff412de65fc216f326448c52a.png" />
</div>
</div>
<blockquote>
<div><p><strong>Exercise 7:</strong> Let us evaluate the Tram performance for different maximum accelerations a=[0.5, 0.8, 1.1] to see a trend on energy demand. As whe did not put any efficiency and by comparing the different resistive forces (Crr=0.006/10, so lowered to a factor 10) can this result be explained?</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">interp</span>

<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">BrakeRatioMax</span><span class="o">=</span><span class="mf">1.0</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span>

<span class="c1"># Treat 0.5m/s² acceleration</span>
<span class="n">k1_value</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k1</span><span class="p">)</span>
<span class="n">k3_value</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k3</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">k1_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k3_value</span><span class="p">]</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Treat 0.8m/s² acceleration</span>
<span class="n">k1_value</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k1</span><span class="p">)</span>
<span class="n">k3_value</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k3</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">k1_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k3_value</span><span class="p">]</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Treat 1.1m/s² acceleration</span>
<span class="n">k1_value</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k1</span><span class="p">)</span>
<span class="n">k3_value</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k3</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">k1_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k3_value</span><span class="p">]</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">11</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">update_acc</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">k1_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k3_value</span><span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">Travel_Tram</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nn">Cell In[3], line 84,</span> in <span class="ni">SimulSection.solver</span><span class="nt">(self, profile_ratios)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>     <span class="n">F</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">BrakeRatioMax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Fmax</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> <span class="c1"># Perform a simple Euler integration from t to t+dt</span>
<span class="ne">---&gt; </span><span class="mi">84</span> <span class="n">dydt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="c1"># Save vectors</span>

<span class="nn">Cell In[3], line 47,</span> in <span class="ni">SimulSection.derivative</span><span class="nt">(self, y, F)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">x</span><span class="p">,</span> <span class="n">dxdt</span> <span class="o">=</span> <span class="n">y</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1"># Define derivative d²xdt²</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="c1">###############################################</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="c1"># CODE 2</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="c1">###############################################</span>
<span class="ne">---&gt; </span><span class="mi">47</span> <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dxdt2</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="k">return</span> <span class="n">dydt</span>

<span class="ne">NameError</span>: name &#39;dxdt2&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="automatically-find-speed-profile-decomposition-k1-k2-k3-with-an-optimization-process">
<h2><span class="section-number">8.4.3. </span>Automatically find speed profile decomposition (k1, k2, k3) with an optimization process<a class="headerlink" href="#automatically-find-speed-profile-decomposition-k1-k2-k3-with-an-optimization-process" title="Link to this heading">#</a></h2>
<p>In a more general case and contrary to the previous hypothesis, the braking decceleration is not necessarily egual in magnitude to the acceleration, especially when doing regenerative braking (maximum power limited by energy storage). The following paper shows that it is possible to optimize the consumption of a tram by optimizing its profile:</p>
<blockquote>
<div><p>Tian, Z., Zhao, N., Hillmansen, S., Roberts, C., Dowens, T., &amp; Kerr, C. (2019). SmartDrive: Traction energy optimization and applications in rail systems. IEEE Transactions on Intelligent Transportation Systems, 20(7), 2764-2773.</p>
</div></blockquote>
<p>The previous class is extended to allow optimizing the parameters defining the profile shape <span class="math notranslate nohighlight">\(k_1, k_2, k_3\)</span> with respect to different objectives: energy consumption (considering regenerative power) and max energy discharge. Only the first objective is given.</p>
<blockquote>
<div><p><strong>Exercise 8:</strong> Write the gradient optimization for max energy discharge objective (modify directely the code and use arguments of objectifConco method).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin_slsqp</span><span class="p">,</span> <span class="n">differential_evolution</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">class</span> <span class="nc">OptimSection</span><span class="p">(</span><span class="n">SimulSection</span><span class="p">):</span>
    
    <span class="c1"># Define objective to optimize: here normalized (divided by rolling resistance equivalent work) total consummed energy (including regenerative power)</span>
    <span class="k">def</span> <span class="nf">objectifConso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">NRJmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Weight</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Crr</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">pen</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mf">1e2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contraintes</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="n">pen</span><span class="o">=</span><span class="n">pen</span><span class="o">*</span><span class="p">(</span><span class="n">pen</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pen</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NRJsection</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">NRJmin</span><span class="o">+</span><span class="n">pen</span><span class="p">)</span>   
        
    <span class="c1"># Define constraints to verify: traveled distance, traveled time (similar to average speed)</span>
    <span class="k">def</span> <span class="nf">contraintes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">TimeTravel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">MeanSpeed</span>  
        <span class="k">return</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">xsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span> <span class="p">(</span><span class="n">TimeTravel</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">TimeTravel</span><span class="p">]</span>    

    <span class="c1"># SLSQP gradient optimization with constraints</span>
    <span class="k">def</span> <span class="nf">optimizeConso_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
        <span class="n">Xbound</span><span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">.99</span><span class="p">)]</span>
        <span class="n">Xopt</span><span class="o">=</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objectifConso</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">f_ieqcons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contraintes</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">Xbound</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;gradient&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>      
        <span class="k">return</span> <span class="n">Xopt</span>
    
    <span class="c1"># Differential evolution optimization    </span>
    <span class="k">def</span> <span class="nf">optimizeConso_genetic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
        <span class="n">Xbound</span><span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.99</span><span class="p">)]</span>
        <span class="n">res</span><span class="o">=</span><span class="n">differential_evolution</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objectifConso</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;genetic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="o">=</span><span class="n">Xbound</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>

     <span class="c1"># SLSQP gradient optimization with constraints [MAX ENERGY]</span>
    <span class="k">def</span> <span class="nf">optimizeConso2_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
        <span class="n">Xbound</span><span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">.99</span><span class="p">)]</span>
        <span class="n">Xopt</span><span class="o">=</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objectifConso</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">f_ieqcons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contraintes</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">Xbound</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;gradient&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>      
        <span class="k">return</span> <span class="n">Xopt</span>
    
</pre></div>
</div>
</div>
</div>
<p>The usage of the class is quite simular that the previous one, but it adds an <code class="docutils literal notranslate"><span class="pre">optimizeConso</span></code> method which enables us to find the <span class="math notranslate nohighlight">\(k_1, k_2, k_3\)</span> set. Let us apply it to the tram travel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definition of the section under study</span>
<span class="n">Travel_optim</span> <span class="o">=</span> <span class="n">OptimSection</span><span class="p">(</span><span class="n">Vehicle</span><span class="o">=</span><span class="n">Tram</span><span class="p">,</span> <span class="n">Distance</span><span class="o">=</span><span class="mi">670</span><span class="p">,</span> <span class="n">MeanSpeed</span><span class="o">=</span><span class="mi">26</span><span class="o">*</span><span class="mf">1e3</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">BrakeRatioMax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Initial variables vector</span>
<span class="n">X_init</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">]</span>

<span class="c1"># Optimization of the consumption with gradient</span>
<span class="n">Xopt1</span><span class="o">=</span><span class="n">Travel_optim</span><span class="o">.</span><span class="n">optimizeConso_gradient</span><span class="p">(</span><span class="n">X_init</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal vector :&quot;</span><span class="p">,</span> <span class="n">Xopt1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constraints vector :&quot;</span><span class="p">,</span> <span class="n">Travel_optim</span><span class="o">.</span><span class="n">contraintes</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">))</span>

<span class="n">Travel_optim</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">)</span>
<span class="n">Travel_optim</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Travel_optim</span><span class="o">.</span><span class="n">ConsumptionPerPax</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">)</span>
<span class="n">Travel_optim</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">X_init</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="c1"># Optimization of the consumption with gradient</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">Xopt1</span><span class="o">=</span><span class="n">Travel_optim</span><span class="o">.</span><span class="n">optimizeConso_gradient</span><span class="p">(</span><span class="n">X_init</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal vector :&quot;</span><span class="p">,</span> <span class="n">Xopt1</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constraints vector :&quot;</span><span class="p">,</span> <span class="n">Travel_optim</span><span class="o">.</span><span class="n">contraintes</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">))</span>

<span class="nn">Cell In[8], line 26,</span> in <span class="ni">OptimSection.optimizeConso_gradient</span><span class="nt">(self, x0)</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="k">def</span> <span class="nf">optimizeConso_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span>     <span class="n">Xbound</span><span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">.99</span><span class="p">)]</span>
<span class="ne">---&gt; </span><span class="mi">26</span>     <span class="n">Xopt</span><span class="o">=</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objectifConso</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">f_ieqcons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contraintes</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">Xbound</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;gradient&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>      
<span class="g g-Whitespace">     </span><span class="mi">27</span>     <span class="k">return</span> <span class="n">Xopt</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/optimize/_slsqp_py.py:210,</span> in <span class="ni">fmin_slsqp</span><span class="nt">(func, x0, eqcons, f_eqcons, ieqcons, f_ieqcons, bounds, fprime, fprime_eqcons, fprime_ieqcons, args, iter, acc, iprint, disp, full_output, epsilon, callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span> <span class="k">if</span> <span class="n">f_ieqcons</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>     <span class="n">cons</span> <span class="o">+=</span> <span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">f_ieqcons</span><span class="p">,</span> <span class="s1">&#39;jac&#39;</span><span class="p">:</span> <span class="n">fprime_ieqcons</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span>               <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="n">args</span><span class="p">},</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">210</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_minimize_slsqp</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">fprime</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span>                       <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">if</span> <span class="n">full_output</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span>     <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;nit&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/optimize/_slsqp_py.py:338,</span> in <span class="ni">_minimize_slsqp</span><span class="nt">(func, x0, args, jac, bounds, constraints, maxiter, ftol, iprint, disp, eps, callback, finite_diff_rel_step, **unknown_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span> <span class="c1"># Set the parameters that SLSQP will need</span>
<span class="g g-Whitespace">    </span><span class="mi">335</span> <span class="c1"># meq, mieq: number of equality and inequality constraints</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span> <span class="n">meq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">[</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">](</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]))</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span>           <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cons</span><span class="p">[</span><span class="s1">&#39;eq&#39;</span><span class="p">]]))</span>
<span class="ne">--&gt; </span><span class="mi">338</span> <span class="n">mieq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">[</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">](</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]))</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cons</span><span class="p">[</span><span class="s1">&#39;ineq&#39;</span><span class="p">]]))</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span> <span class="c1"># m = The total number of constraints</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="n">m</span> <span class="o">=</span> <span class="n">meq</span> <span class="o">+</span> <span class="n">mieq</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/optimize/_slsqp_py.py:338,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span> <span class="c1"># Set the parameters that SLSQP will need</span>
<span class="g g-Whitespace">    </span><span class="mi">335</span> <span class="c1"># meq, mieq: number of equality and inequality constraints</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span> <span class="n">meq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">[</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">](</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]))</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span>           <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cons</span><span class="p">[</span><span class="s1">&#39;eq&#39;</span><span class="p">]]))</span>
<span class="ne">--&gt; </span><span class="mi">338</span> <span class="n">mieq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">[</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">](</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]))</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cons</span><span class="p">[</span><span class="s1">&#39;ineq&#39;</span><span class="p">]]))</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span> <span class="c1"># m = The total number of constraints</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="n">m</span> <span class="o">=</span> <span class="n">meq</span> <span class="o">+</span> <span class="n">mieq</span>

<span class="nn">Cell In[8], line 19,</span> in <span class="ni">OptimSection.contraintes</span><span class="nt">(self, x, *args)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="k">def</span> <span class="nf">contraintes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">19</span>     <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span>     <span class="n">TimeTravel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">MeanSpeed</span>  
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="k">return</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">xsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Distance</span><span class="p">,</span> <span class="p">(</span><span class="n">TimeTravel</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">tsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">TimeTravel</span><span class="p">]</span>

<span class="nn">Cell In[3], line 84,</span> in <span class="ni">SimulSection.solver</span><span class="nt">(self, profile_ratios)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>     <span class="n">F</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">BrakeRatioMax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Fmax</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> <span class="c1"># Perform a simple Euler integration from t to t+dt</span>
<span class="ne">---&gt; </span><span class="mi">84</span> <span class="n">dydt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="c1"># Save vectors</span>

<span class="nn">Cell In[3], line 47,</span> in <span class="ni">SimulSection.derivative</span><span class="nt">(self, y, F)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">x</span><span class="p">,</span> <span class="n">dxdt</span> <span class="o">=</span> <span class="n">y</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1"># Define derivative d²xdt²</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="c1">###############################################</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="c1"># CODE 2</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="c1">###############################################</span>
<span class="ne">---&gt; </span><span class="mi">47</span> <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dxdt2</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="k">return</span> <span class="n">dydt</span>

<span class="ne">NameError</span>: name &#39;dxdt2&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Optimization of the consumption with genetic algorithm</span>
<span class="n">X_init</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]</span>
<span class="n">Xopt1</span><span class="o">=</span><span class="n">Travel_optim</span><span class="o">.</span><span class="n">optimizeConso_genetic</span><span class="p">(</span><span class="n">X_init</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal vector :&quot;</span><span class="p">,</span> <span class="n">Xopt1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constraints vector :&quot;</span><span class="p">,</span> <span class="n">Travel_optim</span><span class="o">.</span><span class="n">contraintes</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">))</span>

<span class="n">Travel_optim</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">)</span>
<span class="n">Travel_optim</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">Travel_optim</span><span class="o">.</span><span class="n">ConsumptionPerPax</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">)</span>
<span class="n">Travel_optim</span><span class="o">.</span><span class="n">MaxEnergyPoint</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Optimization of the consumption with genetic algorithm</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">X_init</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">Xopt1</span><span class="o">=</span><span class="n">Travel_optim</span><span class="o">.</span><span class="n">optimizeConso_genetic</span><span class="p">(</span><span class="n">X_init</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal vector :&quot;</span><span class="p">,</span> <span class="n">Xopt1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constraints vector :&quot;</span><span class="p">,</span> <span class="n">Travel_optim</span><span class="o">.</span><span class="n">contraintes</span><span class="p">(</span><span class="n">Xopt1</span><span class="p">))</span>

<span class="nn">Cell In[8], line 32,</span> in <span class="ni">OptimSection.optimizeConso_genetic</span><span class="nt">(self, x0)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="k">def</span> <span class="nf">optimizeConso_genetic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="n">Xbound</span><span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.99</span><span class="p">)]</span>
<span class="ne">---&gt; </span><span class="mi">32</span>     <span class="n">res</span><span class="o">=</span><span class="n">differential_evolution</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objectifConso</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;genetic&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bounds</span><span class="o">=</span><span class="n">Xbound</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span>     <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/optimize/_differentialevolution.py:502,</span> in <span class="ni">differential_evolution</span><span class="nt">(func, bounds, args, strategy, maxiter, popsize, tol, mutation, recombination, seed, callback, disp, polish, init, atol, updating, workers, constraints, x0, integrality, vectorized)</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span> <span class="c1"># using a context manager means that any created Pool objects are</span>
<span class="g g-Whitespace">    </span><span class="mi">486</span> <span class="c1"># cleared up.</span>
<span class="g g-Whitespace">    </span><span class="mi">487</span> <span class="k">with</span> <span class="n">DifferentialEvolutionSolver</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span>                                  <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span>                                  <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span>                                  <span class="n">integrality</span><span class="o">=</span><span class="n">integrality</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span>                                  <span class="n">vectorized</span><span class="o">=</span><span class="n">vectorized</span><span class="p">)</span> <span class="k">as</span> <span class="n">solver</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">502</span>     <span class="n">ret</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span> <span class="k">return</span> <span class="n">ret</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/optimize/_differentialevolution.py:1155,</span> in <span class="ni">DifferentialEvolutionSolver.solve</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1150</span>     <span class="bp">self</span><span class="o">.</span><span class="n">feasible</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_violation</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1151</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_population_feasibilities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1153</span>     <span class="c1"># only work out population energies for feasible solutions</span>
<span class="g g-Whitespace">   </span><span class="mi">1154</span>     <span class="bp">self</span><span class="o">.</span><span class="n">population_energies</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feasible</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">1155</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_population_energies</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1156</span>             <span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feasible</span><span class="p">]))</span>
<span class="g g-Whitespace">   </span><span class="mi">1158</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_promote_lowest_energy</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1160</span> <span class="c1"># do the optimization.</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/optimize/_differentialevolution.py:1315,</span> in <span class="ni">DifferentialEvolutionSolver._calculate_population_energies</span><span class="nt">(self, population)</span>
<span class="g g-Whitespace">   </span><span class="mi">1313</span> <span class="n">parameters_pop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale_parameters</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1314</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1315</span>     <span class="n">calc_energies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1316</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_mapwrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">parameters_pop</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">S</span><span class="p">])</span>
<span class="g g-Whitespace">   </span><span class="mi">1317</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1318</span>     <span class="n">calc_energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">calc_energies</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1319</span> <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1320</span>     <span class="c1"># wrong number of arguments for _mapwrapper</span>
<span class="g g-Whitespace">   </span><span class="mi">1321</span>     <span class="c1"># or wrong length returned from the mapper</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/scipy/_lib/_util.py:441,</span> in <span class="ni">_FunctionWrapper.__call__</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">441</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

<span class="nn">Cell In[8], line 8,</span> in <span class="ni">OptimSection.objectifConso</span><span class="nt">(self, x, *args)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="k">def</span> <span class="nf">objectifConso</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">8</span>     <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">NRJmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xsection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Weight</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Crr</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>

<span class="nn">Cell In[3], line 84,</span> in <span class="ni">SimulSection.solver</span><span class="nt">(self, profile_ratios)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>     <span class="n">F</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">BrakeRatioMax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Vehicle</span><span class="o">.</span><span class="n">Fmax</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> <span class="c1"># Perform a simple Euler integration from t to t+dt</span>
<span class="ne">---&gt; </span><span class="mi">84</span> <span class="n">dydt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="c1"># Save vectors</span>

<span class="nn">Cell In[3], line 47,</span> in <span class="ni">SimulSection.derivative</span><span class="nt">(self, y, F)</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="n">x</span><span class="p">,</span> <span class="n">dxdt</span> <span class="o">=</span> <span class="n">y</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1"># Define derivative d²xdt²</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="c1">###############################################</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> <span class="c1"># CODE 2</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="c1">###############################################</span>
<span class="ne">---&gt; </span><span class="mi">47</span> <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dxdt2</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="k">return</span> <span class="n">dydt</span>

<span class="ne">NameError</span>: name &#39;dxdt2&#39; is not defined
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Exercise 9:</strong> For Tram, compare this optimized profile to a profile with only 3 segments (maximum acceleration, constant speed, maximum deceleration): is the result really different. Now, evaluate it for the bus and analyse the impact of the variation of the braking ratio for exemple.</p>
</div></blockquote>
</section>
<section id="different-vehicules-energetic-comparison">
<h2><span class="section-number">8.4.4. </span>Different vehicules energetic comparison<a class="headerlink" href="#different-vehicules-energetic-comparison" title="Link to this heading">#</a></h2>
<blockquote>
<div><p><strong>Exercise 10:</strong> For the same travel (distance, mean speed) compare the consumption of different vehicles (tramway, tram, bus, car). The function <code class="docutils literal notranslate"><span class="pre">ConsumptionPerPax</span></code> return and print the consumption per km and per passenger. Compare the results with this <a class="reference external" href="https://reporterre.net/Taxis-volants-aux-JO-un-avis-defavorable-sur-le-projet">publication</a>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calculation of energy consumption of different vehicles: &quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calculation of energy consumption of different vehicles: 
----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trolleybus :&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trolleybus :
----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bus :&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bus :
----
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Car :&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Car :
----
</pre></div>
</div>
</div>
</div>
</section>
<section id="homework">
<h2><span class="section-number">8.4.5. </span>Homework<a class="headerlink" href="#homework" title="Link to this heading">#</a></h2>
<p>Read the following paper before next session to understand how hybridation analysis can be implemented at profile level:</p>
<blockquote>
<div><p>Jaafar, A., Sareni, B., Roboam, X., &amp; Thiounn-Guermeur, M. (2010, September). Sizing of a hybrid locomotive based on accumulators and ultracapacitors. In 2010 IEEE Vehicle Power and Propulsion Conference (pp. 1-6). IEEE. [<a class="reference external" href="https://raw.githubusercontent.com/SizingLab/sizing_course/main/laboratories/Lab-watt_project/assets/papers/Sizing_of_a_hybrid_locomotive_based_on_accumulators_and_ultracapacitors.pdf">pdf</a>]</p>
</div></blockquote>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./laboratories/Lab-watt_project"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01a_CaseStudy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8.2. </span>Case study presentation</p>
      </div>
    </a>
    <a class="right-next"
       href="02b_Architecture_Hybrid-Student.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.5. </span>TD1/2 - Hydrid storage architecture &amp; specification [Student version]</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">8.3. TP1 - Case study specification [Student Version]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">8.4. Table of Contents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vehicles-definition">8.4.1. Vehicles definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mission-profile-definition-and-consumption-simulation">8.4.2. Mission profile definition and consumption simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatically-find-speed-profile-decomposition-k1-k2-k3-with-an-optimization-process">8.4.3. Automatically find speed profile decomposition (k1, k2, k3) with an optimization process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#different-vehicules-energetic-comparison">8.4.4. Different vehicules energetic comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework">8.4.5. Homework</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marc Budinger, Scott Delbecq, Félix Pollet, Aurélien Reysset
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>